<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC '-//ibatis.apache.org//DTD Sql Map 2.0//EN' 'http://ibatis.apache.org/dtd/sql-map-2.dtd'>
<sqlMap namespace="Buyer">

	<typeAlias alias="BuyerDTO" type="user.buyer.dto.BuyerDTO" />

	<!-- 구매자 리절트 맵 정의 -->
	<resultMap id="BuyerResult" class="BuyerDTO">
		<result property="buyer_id" column="buyer_id" />
		<result property="buyer_pw" column="buyer_pw" />
		<result property="buyer_name" column="buyer_name" />
		<result property="buyer_reg_date" column="buyer_reg_date" />
		<result property="buyer_email" column="buyer_email" />
		<result property="buyer_phonenumber" column="buyer_phonenumber" />
		<result property="buyer_gender" column="buyer_gender" />
	</resultMap>

	<!-- 공통으로 사용할 select 절 정의 -->
	<sql id="selectAll">
		SELECT * FROM buyer_table
	</sql>
	
	<!-- 공통으로 사용할 where-user_id 절 정의 -->
	<sql id="whereBuyerId">
		WHERE buyer_id = #buyer_id#
	</sql>

	<!-- select 쿼리문 정의 -->
	<select id="selectOrderByRegDate" resultMap="BuyerResult" parameterClass="BuyerDTO">
		<include refid="selectAll" />
		ORDER BY buyer_reg_date DESC
	</select>
	
	<select id="selectBuyerId" resultMap="BuyerResult" parameterClass="BuyerDTO">
		<include refid="selectAll" />
		<include refid="whereBuyerId" />
	</select>

	<select id="selectBuyerPassword" resultMap="BuyerResult">
		<include refid="selectAll" />
		<include refid="whereBuyerId" />
		AND buyer_pw = #buyer_pw#
	</select>

	<!-- insert 쿼리문 정의 -->
	<insert id="insert" parameterClass="BuyerDTO">
		INSERT INTO buyer_table (buyer_id,
								buyer_pw,
								buyer_name,
								buyer_reg_date,
								buyer_email,
								buyer_phonenumber,
								buyer_gender
								)
						VALUES (#buyer_id#,
								#buyer_pw#,
								#buyer_name#,
								sysdate,
								#buyer_email#,
								#buyer_phonenumber#,
								#buyer_gender#
								)
	</insert>

	<!-- update 쿼리문 정의 -->
	<update id="update" parameterClass="BuyerDTO">
		UPDATE buyer_table SET buyer_pw = #buyer_pw#,
								buyer_name = #buyer_name#,
								buyer_email = #buyer_email#,
								buyer_phonenumber = #buyer_phonenumber#
		<include refid="whereBuyerId" />
	</update>

	<!-- delete 쿼리문 정의 -->
	<delete id="delete" parameterClass="BuyerDTO">
		DELETE FROM buyer_table
		<include refid="whereBuyerId" />
	</delete>

</sqlMap>