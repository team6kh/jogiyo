<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC '-//ibatis.apache.org//DTD Sql Map 2.0//EN' 'http://ibatis.apache.org/dtd/sql-map-2.dtd'>
<sqlMap namespace="Rest">

	<typeAlias alias="RestDTO" type="board.rest.dto.RestDTO" />
	<typeAlias alias="RestoptDTO" type="board.restopt.dto.RestoptDTO" />



		<!-- 리절트 맵 정의 -->
	  	<resultMap id="RestBoard" class="RestDTO">
			
		  	<result property="rest_num" column="rest_num"/>
		  	<result property="rest_subject" column="rest_subject"/>
		  	<result property="rest_price" column="rest_price"/>
		  	<result property="rest_amount" column="rest_amount"/>
		  	<result property="rest_localcategory" column="rest_localcategory"/>
		  	<result property="rest_typecategory" column="rest_typecategory"/>
		  	<result property="rest_destFile1" column="rest_destFile1"/>
		  	<result property="rest_main_orgname" column="rest_main_orgname"/>
		  	<result property="rest_main_savname" column="rest_main_savname"/>
		  	<result property="rest_destFile2" column="rest_destFile2"/>
		  	<result property="rest_content_orgname" column="rest_content_orgname"/>
		  	<result property="rest_content_savname" column="rest_content_savname"/>
		  	<result property="rest_writer_name" column="rest_writer_name"/>
		  	<result property="rest_writer_telnum" column="rest_writer_telnum"/>
		  	<result property="rest_writer_mobilenum" column="rest_writer_mobilenum"/>
		  	<result property="rest_writer_address" column="rest_writer_address"/>
		  	<result property="rest_readcount" column="rest_readcount"/>
		  	<result property="rest_reg_date" column="rest_reg_date"/>
		  	
		</resultMap>
		
		<resultMap id="RestoptBoard" class="RestoptDTO">
			<result property="restopt_num" column="restopt_num"/>
			<result property="restopt_rest_num" column="restopt_rest_num"/>
			<result property="restopt_subject" column="restopt_subject"/>
			<result property="restopt_priceplus" column="restopt_priceplus"/>
		</resultMap>
		
		
		
		
		
		
		<!-- 공통정의 -->
		<sql id="select-all">
			select * from Rest_board 
		</sql>
		
		<sql id="where-num">
			where rest_num = #rest_num#
		</sql>
	
	



	
		<!-- insert -->
		<insert id="insertRest_num" parameterClass="RestDTO">
			INSERT INTO Rest_board (rest_num, rest_subject, rest_price, rest_localcategory, rest_typecategory, rest_writer_name, rest_writer_telnum, rest_writer_mobilenum, rest_writer_address, rest_reg_date)
			VALUES (rest_seq_num.NEXTVAL, #rest_subject#, #rest_price#, #rest_localcategory#, #rest_typecategory#, #rest_writer_name#, #rest_writer_telnum#, #rest_writer_mobilenum#, #rest_writer_address#, #rest_reg_date#)
		</insert>
		
		<insert id="insertRestopt" parameterClass="RestoptDTO">
			INSERT INTO RestOpt_Board (restopt_num, restopt_rest_num, restopt_subject, restopt_priceplus)
			VALUES (restopt_seq_num.NEXTVAL, #restopt_rest_num#, #restopt_subject#, #restopt_priceplus#)
		</insert>
		
		
		
		
		<!-- select -->
		<select id="selectLastNo" resultClass="RestDTO" parameterClass="int">
			SELECT max(rest_num) as rest_num FROM Rest_board 
		</select>
		
		<select id="selectAll" resultMap="RestBoard" parameterClass="int">
			<include refid="select-all" />
			ORDER BY rest_num DESC
		</select>
		
		<select id="selectRestOne" resultMap="RestBoard" parameterClass="int">
			<include refid="select-all" />
			<include refid="where-num" />
		</select>
		
		<select id="selectRestoptOne" resultMap="RestoptBoard" parameterClass="int">
			select * from RestOpt_Board
			where restopt_rest_num = #restopt_rest_num#
		</select>
		
		

		
		<!-- update -->
		<update id="updateRestBoard" parameterClass="RestDTO">
   			UPDATE Rest_board SET rest_subject = #rest_subject#,
   								rest_price = #rest_price#, 
   								rest_localcategory = #rest_localcategory#,
   								rest_typecategory = #rest_typecategory#, 
   								rest_writer_name = #rest_writer_name#, 
   								rest_writer_telnum = #rest_writer_telnum#,
   								rest_writer_mobilenum = #rest_writer_mobilenum#,
   								rest_writer_address = #rest_writer_address#,
   								rest_reg_date = #rest_reg_date#
			<include refid="where-num" />
   		</update>
		
		<update id="updateFile" parameterClass="RestDTO">
   			UPDATE Rest_board SET rest_destFile1 = #rest_destFile1#,
   								rest_main_orgname = #rest_main_orgname#, 
   								rest_main_savname = #rest_main_savname#,
   								rest_destFile2 = #rest_destFile2#, 
   								rest_content_orgname = #rest_content_orgname#, 
   								rest_content_savname = #rest_content_savname#
			<include refid="where-num" />
   		</update>
	
		<update id="updateRest_readcount" parameterClass="RestDTO">
 			UPDATE Rest_board SET rest_readcount = rest_readcount + 1
			<include refid="where-num" />
		</update>
		
		
		
		
		<!-- delete -->
		<delete id="tempArticleDelete" parameterClass="RestDTO">
			DELETE FROM Rest_board
			<include refid="where-num" />
   		 </delete>
	
	
	

</sqlMap>

