<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC '-//ibatis.apache.org//DTD Sql Map 2.0//EN' 'http://ibatis.apache.org/dtd/sql-map-2.dtd'>
<sqlMap namespace="Notice">

	<typeAlias alias="notice" type="board.notice.dto.NoticeDTO" />

	<!-- 리절트 맵 정의 -->
	<resultMap id="noticeResAll" class="notice">
		<result property="notice_num" column="notice_num" />
		<result property="notice_headtag" column="notice_headtag" />
		<result property="notice_subject" column="notice_subject" />
		<result property="notice_content" column="notice_content" />
		<result property="notice_reg_date" column="notice_reg_date" />
		<result property="notice_readcount" column="notice_readcount" />
		<result property="rnum" column="rnum" />
	</resultMap>
	
	<resultMap id="noticeRes" class="notice">
		<result property="notice_num" column="notice_num" />
		<result property="notice_headtag" column="notice_headtag" />
		<result property="notice_subject" column="notice_subject" />
		<result property="notice_content" column="notice_content" />
		<result property="notice_reg_date" column="notice_reg_date" />
		<result property="notice_readcount" column="notice_readcount" />
	</resultMap>

	<!-- 공통으로 사용할 select 절 정의 -->
	<sql id="select-all">
		SELECT * FROM NOTICE_BOARD
	</sql>

	<!-- 공통으로 사용할 where-notice_num 절 정의 -->
	<sql id="where-notice_num">
		WHERE NOTICE_NUM = #notice_num#
	</sql>


	<!-- select 쿼리문 정의 -->
	<select id="Notice.selectAll" resultMap="noticeResAll" >
		select * from (select notice_num,notice_headtag,notice_subject,notice_content,notice_reg_date,notice_readcount,rownum rnum from (select * from notice_board ORDER BY notice_num))order by rnum desc
	</select>
	
	<select id="Notice.selectOne" resultMap="noticeRes"
		parameterClass="int">
		<include refid="select-all" />
		<include refid="where-notice_num" />
	</select>
	
	<!-- notice_board의 게시글 총 갯수 -->
	<select id="Notice.selectNCount" resultClass="notice" parameterClass="int">
		SELECT count(notice_num) as NOTICE_NUM FROM NOTICE_BOARD
	</select>
	
	<!-- insert 쿼리문 정의 -->
	<insert id="Notice.insertNotice" parameterClass="notice">

		INSERT INTO
		NOTICE_BOARD (NOTICE_NUM,
		NOTICE_HEADTAG,
		NOTICE_SUBJECT,
		NOTICE_CONTENT,
		NOTICE_REG_DATE
		)
		VALUES (NOTICE_BOARD_SEQ.NEXTVAL,
		#notice_headtag#,
		#notice_subject#,
		#notice_content#,
		#notice_reg_date#
		)
	</insert>


	<!-- update 쿼리문 정의 -->
	<update id="Notice.updateNotice" parameterClass="notice">
		UPDATE NOTICE_BOARD SET NOTICE_HEADTAG = #notice_headtag#,
		NOTICE_SUBJECT = #notice_subject#,
		NOTICE_CONTENT = #notice_content#
		<include refid="where-notice_num" />
	</update>

	<update id="Notice.updateReadCount" parameterClass="notice">
		UPDATE NOTICE_BOARD SET NOTICE_READCOUNT = notice_readcount + 1
		<include refid="where-notice_num" />
	</update>

	<!-- delete 쿼리문 정의 -->
	<delete id="Notice.deleteNotice" parameterClass="notice">
		DELETE FROM NOTICE_BOARD
		<include refid="where-notice_num" />
	</delete>

</sqlMap>

