<!DOCTYPE struts PUBLIC
    "-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"
    "http://struts.apache.org/dtds/struts-2.0.dtd">

<struts>	
	<package name="struts_common" extends="struts-default">

		<!-- SqlMapClient 인터셉터 -->
		<interceptors>
			<interceptor name="conDAO" class="common.ConDAOInterceptor"/>
		</interceptors>

		<!-- 로그인/로그아웃 -->

		<!-- 로그인 폼 -->
		<action name="loginForm" class="common.login.action.LoginAction" method="loginForm">
			<result>/common/login/loginForm.jsp</result>
		</action>

		<!-- 로그인 액션 -->
		<action name="login" class="common.login.action.LoginAction">
			<interceptor-ref name="chain"/>		
			<interceptor-ref name="params" />				
			<interceptor-ref name="conDAO" />
			<interceptor-ref name="servletConfig" />
			<result name="error">/common/error.jsp</result>
			<result name="success" type="redirect-action">${actionName}</result>
		</action>

		<!-- 로그아웃 액션 -->
		<action name="logout" class="common.logout.action.LogoutAction">
			<interceptor-ref name="chain"/>	
			<interceptor-ref name="servletConfig" />
			<result name="success" type="redirect-action">home</result>
		</action>
		
		<!-- 회원가입/수정/탈퇴 -->

		<!-- 회원가입 폼 -->
		<action name="registrationForm" class="common.registration.action.RegistrationFormAction">
			<result name="buyer">/common/registration/regBuyerForm.jsp</result>
			<result name="seller">/common/registration/regSellerForm.jsp</result>
			<result>/common/registration/regBuyerForm.jsp</result>
		</action>
		
		<!-- 아이디 중복체크 액션 -->		
		<action name="checkDup" class="common.CheckDuplicateAction">
			<interceptor-ref name="params" />				
			<interceptor-ref name="conDAO" />
			<result>/common/registration/checkDup.jsp</result>
		</action>	

		<!-- 회원가입 액션 : 구매자, 판매자로 chain -->
		<action name="registration" class="common.registration.action.RegistrationAction">
			<result name="buyer" type="chain">regBuyer</result>
			<result name="seller" type="chain">regSeller</result>
			<result name="error">/common/error.jsp</result>
		</action>

		<!-- 구매자 가입 액션 -->
		<action name="regBuyer" class="common.registration.action.RegBuyerAction">
			<interceptor-ref name="chain"/>
			<interceptor-ref name="prepare"/>
			<interceptor-ref name="modelDriven"/>
			<interceptor-ref name="params"/>
			<interceptor-ref name="conDAO"/>
			<result name="success" type="chain">
          		<param name="actionName">login</param>
        	</result>	
		</action>

		<!-- 판매자 가입 액션 -->
		<action name="regSeller" class="common.registration.action.RegSellerAction">
			<interceptor-ref name="chain"/>
			<interceptor-ref name="prepare"/>
			<interceptor-ref name="modelDriven"/>
			<interceptor-ref name="params"/>
			<interceptor-ref name="conDAO"/>
			<result type="redirect-action">home</result>	
		</action>
		
		<!-- 유저정보 액션 : 구매자, 판매자로 chain -->
		<action name="readUser" class="common.registration.action.ReadUserAction">
			<result name="buyer" type="chain">readBuyer</result>
			<result name="seller" type="chain">readSeller</result>
			<result name="error">/common/error.jsp</result>
		</action>
		
		<!-- 구매자정보 읽기 액션 -->
		<action name="readBuyer" class="common.registration.action.ReadBuyerAction">
			<interceptor-ref name="params"/>
			<interceptor-ref name="conDAO"/>
			<result>/common/registration/readBuyer.jsp</result>
		</action>
		
		<!-- 구매자정보 수정 폼 -->
		<action name="updateBuyerForm" class="common.registration.action.UpdateBuyerAction" method="updateForm">
			<interceptor-ref name="params"/>
			<interceptor-ref name="conDAO"/>
			<result>/common/registration/updateBuyerForm.jsp</result>
		</action>
		
		<!-- 구매자정보 수정 액션 -->
		<action name="updateBuyer" class="common.registration.action.UpdateBuyerAction">
			<interceptor-ref name="params"/>
			<interceptor-ref name="conDAO"/>
			<result>/common/registration/readBuyer.jsp</result>
		</action>
		
		<!-- 구매자정보 삭제 (탈퇴) 액션 -->
		<action name="deleteBuyer" class="common.registration.action.DeleteBuyerAction">
			<interceptor-ref name="params"/>
			<interceptor-ref name="conDAO"/>
			<result name="success" type="chain">
          		<param name="actionName">logout</param>
        	</result>	
		</action>
		
		<!-- HOME -->
		
		<!-- 홈 액션 -->
		<action name="home" class="board.home.action.HomeAction">
			<result>/index.jsp</result>
		</action>
		
		<!-- 공통기능(?) -->
		
		<!-- NEW 비밀번호 체크 액션 -->
		<action name="checkPass" class="common.CheckPasswordAction">
			<interceptor-ref name="params"/>
			<interceptor-ref name="conDAO"/>
			<result name="success" type="chain">
				<param name="actionName">${modalParam}</param>
			</result>			
			<result name="error">/common/error.jsp</result>
		</action>			

	</package>
</struts>