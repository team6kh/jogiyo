<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC '-//ibatis.apache.org//DTD Sql Map 2.0//EN' 'http://ibatis.apache.org/dtd/sql-map-2.dtd'>
<sqlMap namespace="Buyer">

	<typeAlias alias="BuyerDTO" type="user.buyer.dto.BuyerDTO" />

	<!-- 구매자 리절트 맵 정의 -->
	<resultMap id="BuyerResult" class="BuyerDTO">
		<result property="user_seq" column="user_seq" />
		<result property="buyer_id" column="buyer_id" />
		<result property="buyer_pw" column="buyer_pw" />
		<result property="buyer_name" column="buyer_name" />
		<result property="buyer_reg_date" column="buyer_reg_date" />
		<result property="buyer_email" column="buyer_email" />
		<result property="buyer_phonenumber" column="buyer_phonenumber" />
		<result property="buyer_verification" column="buyer_verification" />
	</resultMap>

	<!-- 공통으로 사용할 select 절 정의 -->
	<sql id="select-all">
		SELECT * FROM buyer_table
	</sql>

	<!-- 공통으로 사용할 where-user_id 절 정의 -->
	<sql id="where-buyer_id">
		WHERE buyer_id = #buyer_id#
	</sql>

	<!-- select 쿼리문 정의 -->
	<select id="selectAll" resultMap="BuyerResult" parameterClass="BuyerDTO">
		<include refid="select-all" />
		ORDER BY buyer_reg_date DESC
	</select>

	<select id="selectWhereBuyerId" resultMap="BuyerResult" parameterClass="BuyerDTO">
		<include refid="select-all" />
		<include refid="where-buyer_id" />
	</select>

	<select id="selectWhereBuyerPw" resultMap="BuyerResult">
		<include refid="select-all" />
		<include refid="where-buyer_id" />
		AND buyer_pw = #buyer_pw#
	</select>

	<!-- insert 쿼리문 정의 -->
	<insert id="insertBuyer" parameterClass="BuyerDTO">
		INSERT INTO buyer_table (user_seq,
								buyer_id,
								buyer_pw,
								buyer_name,
								buyer_reg_date,
								buyer_email,
								buyer_phonenumber,
								buyer_verification
								)
						VALUES (user_seq.nextval,
								#buyer_id#,
								#buyer_pw#,
								#buyer_name#,
								#buyer_reg_date#,
								#buyer_email#,
								#buyer_phonenumber#,
								#buyer_verification#
								)
	</insert>

	<!-- update 쿼리문 정의 -->
	<update id="updateBuyer" parameterClass="BuyerDTO">
		UPDATE buyer_table SET buyer_pw = #buyer_pw#,
								buyer_email = #buyer_email#,
								buyer_phonenumber = #buyer_phonenumber#
		<include refid="where-buyer_id" />
	</update>

	<!-- delete 쿼리문 정의 -->
	<delete id="deleteBuyer" parameterClass="BuyerDTO">
		DELETE FROM buyer_table
		<include refid="where-buyer_id" />
	</delete>

</sqlMap>